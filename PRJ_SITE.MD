# PROJECT_SITE.MD â€” Ariadline Marketing Website

> Status: **Planning**  
> Last updated: 2026-02-12

---

## 1. PÅ™ehled

MarketingovÃ½ web pro produkt **Ariadline** ("Untangle your workday.") â€” SaaS pro Å™emeslnÃ­ky
zamÄ›Å™enÃ½ na plÃ¡novÃ¡nÃ­ tras, CRM a sprÃ¡vu pravidelnÃ½ch revizÃ­.

Web je **oddÄ›lenÃ½** od hlavnÃ­ aplikace (kterÃ¡ pouÅ¾Ã­vÃ¡ WebSockets/NATS pro real-time
interaktivitu). Marketing site je statickÃ½ SSG web optimalizovanÃ½ na maximÃ¡lnÃ­ rychlost
naÄtenÃ­, SEO a konverznÃ­ rate.

### KlÃ­ÄovÃ¡ rozhodnutÃ­

| OtÃ¡zka | RozhodnutÃ­ |
|--------|-----------|
| Repo struktura | **Monorepo** â€” novÃ½ workspace `apps/site` vedle `apps/web` a `worker` |
| Framework | **Astro** s React islands |
| Styling | **CSS Modules** (React islands) + **Astro Scoped CSS** (`.astro`) + sdÃ­lenÃ© design tokeny |
| Hosting | **Cloudflare Pages** (statickÃ© HTML na globÃ¡lnÃ­ CDN) |
| Backend formulÃ¡Å™Å¯ | **Cloudflare Pages Functions** (API na stejnÃ© domÃ©nÄ›) |
| Lokalizace | **3 jazyky od startu**: en, cs, sk |
| DomÃ©novÃ© schÃ©ma | `ariadline.com` (web + Pages Functions API `/api/...`), `app.ariadline.com` (SPA), `api.ariadline.com` (hlavnÃ­ aplikace â€” Rust) |
| Registrace/Login | Redirect na `app.ariadline.com` |
| Analytics | **Umami Cloud** (cookie-free, GDPR-compliant, ~2 KB, `defer`) |
| ROI kalkulaÄka | PozdÄ›jÅ¡Ã­ fÃ¡ze (ne v MVP) |

---

## 2. Sitemap â€” struktura strÃ¡nek

```
/                           â†’ Landing page (Hero, Problem/Solution, Features, CTA)
/features                   â†’ DetailnÃ­ popis funkcÃ­ (Routing, CRM, KalendÃ¡Å™)
/pricing                    â†’ CenÃ­k + porovnÃ¡nÃ­ planÅ¯
/blog                       â†’ Blog / Akademie (Astro Content Collections)
/blog/[slug]                â†’ JednotlivÃ½ blogpost
/contact                    â†’ KontaktnÃ­ formulÃ¡Å™ + FAQ
/legal/privacy              â†’ Ochrana osobnÃ­ch ÃºdajÅ¯ (GDPR)
/legal/terms                â†’ ObchodnÃ­ podmÃ­nky / Terms of Service
/legal/cookies              â†’ Cookie policy (i kdyÅ¾ nepouÅ¾Ã­vÃ¡me cookies, je dobrÃ© to uvÃ©st)
```

VÅ¡echny strÃ¡nky existujÃ­ ve vÅ¡ech 3 jazykovÃ½ch verzÃ­ch:
```
/en/...                     â†’ English (default, zobrazÃ­ se i pro /)
/cs/...                     â†’ ÄŒeÅ¡tina
/sk/...                     â†’ SlovenÅ¡tina
```

Root `/` â€” minimalistickÃ½ JS redirect podle `navigator.language` na `/en/`, `/cs/` nebo `/sk/`.
PÅ™i vypnutÃ©m JS je default `/en/` (angliÄtina).

---

## 3. TechnologickÃ½ stack

### 3.1 Frontend: Astro + React Islands

**Astro** generuje statickÃ© HTML pÅ™i buildu (SSG). JavaScript se do prohlÃ­Å¾eÄe posÃ­lÃ¡
pouze pro interaktivnÃ­ "ostrovy" (formulÃ¡Å™e). VÃ½sledek: tÃ©mÄ›Å™ nulovÃ½ JS bundle pro
vÄ›tÅ¡inu strÃ¡nek â†’ Lighthouse 100/100.

| Komponenta | Typ | Hydratace |
|-----------|-----|-----------|
| Hero | `.astro` | Å½Ã¡dnÃ¡ (ÄistÃ© HTML) |
| Features | `.astro` | Å½Ã¡dnÃ¡ |
| Pricing | `.astro` | Å½Ã¡dnÃ¡ |
| Blog post | `.astro` + Content Collections | Å½Ã¡dnÃ¡ |
| Navigace | `.astro` | Å½Ã¡dnÃ¡ (hamburger menu pÅ™es CSS `:target` / details) |
| Language switcher | `.astro` | Å½Ã¡dnÃ¡ (vygenerovanÃ© linky) |
| ContactForm | React `.tsx` | `client:visible` â€” pouze na strÃ¡nce Contact |
| NewsletterForm | React `.tsx` | `client:visible` â€” **vÃ½raznÄ›** na strÃ¡nce Contact, **mÃ©nÄ› vÃ½raznÄ›** v patiÄce na vÅ¡ech strÃ¡nkÃ¡ch |

### 3.2 Styling: CSS Modules + Astro Scoped CSS + Design Tokens

StejnÃ½ pÅ™Ã­stup jako hlavnÃ­ aplikace (`apps/web`) â€” Å¾Ã¡dnÃ½ utility-first framework.

**Dva mechanismy stylovÃ¡nÃ­:**

| Kontext | Technologie | Scope |
|---------|-------------|-------|
| Astro komponenty (`.astro`) | **Astro Scoped CSS** (`<style>` blok) | Automaticky scoped na komponentu |
| React islands (`.tsx`) | **CSS Modules** (`.module.css`) | Scope pÅ™es generovanÃ© class names |
| GlobÃ¡lnÃ­ reset, tokeny | **GlobÃ¡lnÃ­ CSS** (`global.css`) | Import v `Layout.astro` |

**Astro Scoped CSS** â€” styl se pÃ­Å¡e pÅ™Ã­mo v `.astro` souboru:
```astro
<section class="hero">
  <h1>Ariadline</h1>
</section>

<style>
  .hero {
    padding: 5rem 0;
    background: var(--color-bg);
  }
  .hero h1 {
    font-family: var(--font-heading);
    font-size: 3rem;
    font-weight: 800;
    color: var(--color-text);
  }
</style>
```

**CSS Modules** â€” pro React ostrovy:
```tsx
// ContactForm.tsx
import styles from './ContactForm.module.css';
export default function ContactForm() {
  return <form className={styles.form}>...</form>;
}
```

**Design tokeny** â€” sdÃ­lenÃ© CSS custom properties vychÃ¡zejÃ­ z aktuÃ¡lnÃ­ho designu
aplikace (`apps/web/src/index.css`):

```css
/* packages/design-tokens/variables.css */
:root {
  /* PrimÃ¡rnÃ­ barva â€” Science Blue (stÃ¡vajÃ­cÃ­) */
  --color-primary: #2563eb;
  --color-primary-dark: #1d4ed8;

  /* AkcentnÃ­ barva â€” ZlatÃ¡ Ariadline (#D97706, amber-700) */
  /* PouÅ¾itÃ­: logo, trasa na mapÄ› ("Ariadnina nit"), akcenty mimo science blue */
  --color-accent: #D97706;
  --color-accent-light: #F59E0B;   /* SvÄ›tlejÅ¡Ã­ varianta pro hover/subtle akcenty */

  /* NeutrÃ¡lnÃ­ */
  --color-secondary: #64748b;
  --color-bg: #ffffff;
  --color-bg-secondary: #f8fafc;
  --color-border: #e2e8f0;
  --color-text: #1e293b;
  --color-text-secondary: #64748b;

  /* SÃ©mantickÃ© */
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-error: #ef4444;

  /* ZaoblenÃ­ */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;

  /* Fonty */
  --font-body: 'Inter Variable', system-ui, sans-serif;
  --font-heading: 'Montserrat Variable', system-ui, sans-serif;
}
```

**BarevnÃ© schÃ©ma â€” dvÄ› osy:**
- **Science Blue** (`#2563eb`) â€” primÃ¡rnÃ­ barva. DÅ¯vÄ›ryhodnost, profesionalita, UI prvky (navigace, linky, formulÃ¡Å™e).
- **ZlatÃ¡** (`#D97706`) â€” akcentnÃ­ barva. Logo, trasa na mapÄ› ("Ariadnina zlatÃ¡ nit"),
  CTA tlaÄÃ­tka, zvÃ½raznÄ›nÃ­, hover stavy. KontrastnÃ­ pomÄ›r 3:1 na bÃ­lÃ©m mapovÃ©m podkladu.
  UÅ¾ivatel si mÅ¯Å¾e v nastavenÃ­ aplikace zvolit jinou barvu trasy pro vyÅ¡Å¡Ã­ kontrast.

Tokeny budou v sdÃ­lenÃ©m balÃ­Äku (`packages/design-tokens/`). Astro scoped CSS i CSS Modules
pÅ™istupujÃ­ k tokenÅ¯m pÅ™es `var(--color-primary)`, `var(--color-accent)` atd.
Jak generovat `variables.css` z `tokens.json` â€” viz otevÅ™enÃ© otÃ¡zky (sekce 11).

**Logo**: Logotyp Ariadline ve **zlatÃ© barvÄ›** (kruh s A + map piny). UloÅ¾en v `assets/`.

### 3.3 Lokalizace (i18n)

Astro mÃ¡ vestavÄ›nou i18n podporu (od v4+):

- **Routing**: Path prefixes (`/en/`, `/cs/`, `/sk/`)
- **Default locale**: `en` (s `prefixDefaultLocale: true` â€” kaÅ¾dÃ½ jazyk mÃ¡ explicitnÃ­ prefix)
- **PÅ™eklady**: JSON soubory v `src/i18n/` (klÃ­Äe â†’ pÅ™eloÅ¾enÃ© texty)
- **Content Collections**: blogposty v `src/content/blog/en/`, `src/content/blog/cs/`, `src/content/blog/sk/`
- **Language switcher**: Astro helper `getRelativeLocaleUrl()` generuje linky na stejnou strÃ¡nku v jinÃ©m jazyce
- **Auto-detekce jazyka na root `/`**: MinimalistickÃ½ JS redirect podle `navigator.language`;
  pÅ™i vypnutÃ©m JS fallback na `/en/`.

> **Relationship with `apps/web` i18n:** The two apps use **fully separate i18n architectures** (decided â€” see `PRJ_I18N.MD`). `apps/site` uses build-time Astro SSG with URL-based locale routing; `apps/web` uses runtime i18next with state-based locale. No shared translation files. Future improvement: pass locale from site to app via `?lang=cs` query parameter on login/register links.

### 3.4 Analytics: Umami Cloud

**RozhodnutÃ­**: **Umami** s backendem **Umami Cloud** (hosted).

| Vlastnost | Detail |
|-----------|--------|
| Skript | ~2 KB gzipped (vs. 45 KB+ u Google Analytics) |
| Cookies | **Å½Ã¡dnÃ©** (hash z IP + User-Agent) â†’ **nepotÅ™ebujeme cookie banner** |
| GDPR | PlnÄ› compliant bez cookie consent |
| NaÄÃ­tÃ¡nÃ­ | `defer` â€” nestahuje se ani neparsuje, dokud nenÃ­ hotovÃ© HTML |
| Dopad na LCP | NulovÃ½ â€” neblokuje vykreslovÃ¡nÃ­ |
| Licence | MIT |
| Backend | **Umami Cloud** (hosted, zero-maintenance). PozdÄ›ji volitelnÃ¡ migrace na self-hosted. |

**Integrace v `Layout.astro`:**
URL skriptu a `data-website-id` zÃ­skÃ¡me z Umami Cloud dashboardu (napÅ™. `https://eu.umami.is/script.js` nebo podle regionu):
```html
<script
  defer
  src="https://[region].umami.is/script.js"
  data-website-id="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
></script>
```

Skript se vloÅ¾Ã­ do `<head>` v Layout.astro. Atribut `defer` zajistÃ­, Å¾e prohlÃ­Å¾eÄ
skript stÃ¡hne paralelnÄ›, ale spustÃ­ ho aÅ¾ po zparsovÃ¡nÃ­ celÃ©ho HTML.

> **Pozn.**: Partytown (pÅ™esunutÃ­ do Web Workeru) nenÃ­ nutnÃ© â€” 2 KB `defer` skript
> nemÃ¡ mÄ›Å™itelnÃ½ dopad na vÃ½kon. ZbyteÄnÃ¡ komplexita.

### 3.5 SEO & Meta

KaÅ¾dÃ¡ strÃ¡nka bude mÃ­t:
- `<title>` a `<meta name="description">` â€” lokalizovanÃ©
- Open Graph tagy: `og:title`, `og:description`, `og:image`, `og:locale`
- Twitter Card tagy: `twitter:card`, `twitter:title`, `twitter:image`
- Canonical URL (self-referencing)
- `hreflang` tagy pro vÅ¡echny jazykovÃ© verze
- Structured data (JSON-LD): Organization, Product, BlogPosting
- `robots.txt` + `sitemap.xml` (Astro generuje automaticky)

### 3.6 Fonty

**Kombinace: Montserrat (nadpisy) + Inter (body)**

| ÃšÄel | Font | ProÄ |
|------|------|------|
| Nadpisy (h1â€“h6) | **Montserrat Variable** (Bold/ExtraBold) | GeometrickÃ½, Å¡irokÃ½ â€” "dvojÄe" fontu v logu. AutoritativnÃ­ v nadpisech. |
| Body text | **Inter Variable** | ZlatÃ½ standard pro UI a Äitelnost na obrazovkÃ¡ch. NavrÅ¾en pro poÄÃ­taÄovÃ¡ rozhranÃ­. |

**Implementace pro maximÃ¡lnÃ­ rychlost:**

- Instalace pÅ™es **Fontsource** (`@fontsource-variable/montserrat`, `@fontsource-variable/inter`)
  â€” Variable verze = jeden soubor pro vÅ¡echny tlouÅ¡Å¥ky, Å¡etÅ™Ã­ data
- Import v `Layout.astro` (bundluje se lokÃ¡lnÄ›, Å¾Ã¡dnÃ½ DNS lookup na Google Fonts)
- `font-display: swap` (text viditelnÃ½ okamÅ¾itÄ›, font se swapne po naÄtenÃ­)
- `<link rel="preload">` pro Inter (primÃ¡rnÃ­ font) v `<head>`
- Definice v design tokenech: `--font-body` a `--font-heading` (viz sekce 3.2)

**PouÅ¾itÃ­ v Astro Scoped CSS:**
```astro
<h1>Ariadline: Untangle your workday.</h1>
<p>PlÃ¡novÃ¡nÃ­ tras pro Å™emeslnÃ­ky.</p>

<style>
  h1 {
    font-family: var(--font-heading);
    font-size: 3rem;
    font-weight: 800;
  }
  p {
    font-family: var(--font-body);
    font-size: 1.125rem;
  }
</style>
```

### 3.7 ObrÃ¡zky

- FormÃ¡ty: **WebP** / **AVIF** s PNG/JPEG fallback (`<picture>` + `srcset`)
- Astro `<Image>` komponenta s Sharp pro build-time optimalizaci
- Hero screenshot: preloaded (`<link rel="preload" as="image">`)
- Below-the-fold: `loading="lazy"`, `decoding="async"`
- VÅ¡echny obrÃ¡zky majÃ­ explicitnÃ­ `width`/`height` (prevence CLS)

---

## 4. Backend pro formulÃ¡Å™e â€” Cloudflare Pages Functions

### 4.1 ProÄ Pages Functions

| VÃ½hoda | Detail |
|--------|--------|
| **DomÃ©na** | Site API bÄ›Å¾Ã­ na stejnÃ© domÃ©nÄ› (`ariadline.com/api/...`) â€” **Å¾Ã¡dnÃ© CORS**. HlavnÃ­ app API zÅ¯stÃ¡vÃ¡ na `api.ariadline.com`. |
| **Jednoduchost** | Functions v `apps/site/functions/`, deploy spoleÄnÄ› s webem |
| **Izolace** | OddÄ›lenÃ© od hlavnÃ­ aplikace (`api.ariadline.com`). MinimÃ¡lnÃ­ attack surface. |
| **Å kÃ¡lovÃ¡nÃ­** | AutomatickÃ© na edge (0 â†’ nekoneÄno). |
| **NÃ¡klady** | Free tier Pages pokryje realistickÃ½ traffic. |
| **Tooling** | LokÃ¡lnÃ­ vÃ½voj pÅ™es `wrangler pages dev`. |

### 4.2 API endpointy

Soubory v `apps/site/functions/api/`:

| Soubor | Endpoint | Popis |
|--------|----------|-------|
| `contact.ts` | `POST /api/contact` | KontaktnÃ­ formulÃ¡Å™ |
| `newsletter.ts` | `POST /api/newsletter` | OdbÄ›r novinek |

**Request/Response schemas (validace pÅ™es Zod):**

```
POST /api/contact
  Request:  {
    email: string,
    message: string,
    source?: string,
    locale?: string,
    website?: string   // Honeypot â€” skrytÃ© pole, musÃ­ zÅ¯stat prÃ¡zdnÃ©
  }
  Response: { "success": true, "ticketId": "REQ-2026-000123" }

POST /api/newsletter
  Request:  {
    email: string,
    locale?: string,
    gdprConsent: boolean,
    website?: string   // Honeypot â€” skrytÃ© pole, musÃ­ zÅ¯stat prÃ¡zdnÃ©
  }
  Response: { "success": true, "pendingConfirmation": true }
```

**Honeypot anti-spam:**
- Pole `website` â€” skrytÃ© CSS (`position: absolute; left: -9999px`), label napÅ™. "NevyplÅˆujte"
- Pokud je `website` vyplnÄ›no â†’ request se ignoruje, vrÃ¡tÃ­ `{ "success": true }` (fake success, aby bot nedostal zpÄ›tnou vazbu)
- Validace na serveru: `website` musÃ­ bÃ½t prÃ¡zdnÃ½ string nebo undefined
- Cloudflare Turnstile (`cf-turnstile-response`) â€” server-side ovÄ›Å™enÃ­ tokenu ve Function
- Rate limiting na endpoint Ãºrovni (Cloudflare)

**DatabÃ¡ze: Cloudflare D1 (managed SQLite)**
- UklÃ¡dÃ¡nÃ­ kontaktnÃ­ch zprÃ¡v (pro `ticketId` a historii)
- UklÃ¡dÃ¡nÃ­ e-mailÅ¯ z newsletteru
- D1 je pÅ™Ã­stupnÃ¡ z Pages Functions pÅ™es `env.DB`
- **Source of truth** pro newsletter i kontakty je D1
- `ticketId` formÃ¡t: ÄitelnÃ½ `REQ-YYYY-NNNNNN`

**Newsletter: Double opt-in flow**
1. `POST /api/newsletter` uloÅ¾Ã­ zÃ¡znam do D1 se stavem `pending`
2. OdeslÃ¡nÃ­ potvrzovacÃ­ho e-mailu pÅ™es Resend (unikÃ¡tnÃ­ confirm token / link)
3. `GET /api/newsletter/confirm?token=...` pÅ™epne stav na `confirmed`
4. Teprve `confirmed` kontakty se povaÅ¾ujÃ­ za aktivnÃ­ odbÄ›ratele

### 4.3 E-mail: Resend

**RozhodnutÃ­**: **Resend** jako e-mailovÃ¡ sluÅ¾ba pro celÃ½ projekt (site i aplikace).

| Vlastnost | Detail |
|-----------|--------|
| API | REST + TypeScript SDK (`resend` npm balÃ­Äek) |
| Å ablony | **React Email** â€” e-maily jako React komponenty (Å¾Ã¡dnÃ© `<table>` peklo) |
| Free tier | 3 000 e-mailÅ¯/mÄ›sÃ­c, 1 domÃ©na |
| DoruÄitelnost | VysokÃ¡ (dedikovanÃ© IP na vyÅ¡Å¡Ã­ch plÃ¡nech) |
| Integrace | Pages Functions (site) + Rust worker (aplikace, pÅ™es REST API) |

**Architektura:**
```
[ProhlÃ­Å¾eÄ]  â†’  [Pages Function]  â†’  [Resend API] + [D1]
                     (API klÃ­Ä zÅ¯stÃ¡vÃ¡ na serveru)
```

E-maily se **nikdy neodesÃ­lajÃ­ z prohlÃ­Å¾eÄe** â€” API klÃ­Ä zÅ¯stÃ¡vÃ¡ na backendu.

**E-mailovÃ© Å¡ablony (React Email):**
```
apps/site/src/emails/           # Å ablony pro marketing web
  ContactConfirmation.tsx       # PotvrzenÃ­ kontaktnÃ­ho formulÃ¡Å™e
  NewsletterWelcome.tsx         # PÅ™ivÃ­tÃ¡nÃ­ do newsletteru

packages/emails/                # SdÃ­lenÃ© Å¡ablony (site + aplikace)
  WelcomeEmail.tsx              # VÃ­tejte v Ariadline
  PasswordReset.tsx             # Reset hesla
  RevisionReminder.tsx          # PÅ™ipomÃ­nka revize (aplikace)
```

**PÅ™Ã­klad integrace (Pages Function):**
```typescript
// apps/site/functions/api/contact.ts
import { Resend } from 'resend';

export const onRequestPost: PagesFunction = async ({ request, env }) => {
  const resend = new Resend(env.RESEND_API_KEY);
  // ... Zod validace, honeypot check, D1 insert ...
  await resend.emails.send({
    from: 'Ariadline <info@ariadline.com>',
    to: ['admin@ariadline.com'],
    subject: 'NovÃ½ dotaz z webu',
    text: message,
  });
}
```

**Integrace do Rust workeru (aplikace):**
Resend mÃ¡ REST API â€” volÃ¡nÃ­ pÅ™es `reqwest` HTTP klient, Å¾Ã¡dnÃ© SDK nutnÃ©:
```
POST https://api.resend.com/emails
Authorization: Bearer re_xxxxx
Content-Type: application/json
```

**DNS zÃ¡znamy (nutnÃ© pÅ™ed spuÅ¡tÄ›nÃ­m):**

| Typ | NÃ¡zev | ÃšÄel |
|-----|-------|------|
| TXT | `_dkim.ariadline.com` | DKIM â€” podpis autenticity e-mailu |
| TXT | `ariadline.com` | SPF â€” autorizace Resend IP adres pro odesÃ­lÃ¡nÃ­ |
| TXT | `_dmarc.ariadline.com` | DMARC â€” politika pro podvrÅ¾enÃ© e-maily |

VÅ¡echny tÅ™i zÃ¡znamy nastavÃ­ Resend dashboard automaticky (staÄÃ­ kliknout "Verify domain").

---

## 5. Struktura projektu v monorepu

```
/ariadline (root)
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                    # HlavnÃ­ SPA aplikace (React/Vite) â€” beze zmÄ›n
â”‚   â””â”€â”€ site/                   # Marketing web (Astro) â€” NOVÃ
â”‚       â”œâ”€â”€ public/
â”‚       â”‚   â”œâ”€â”€ fonts/          # Fontsource handles this (Inter + Montserrat variable)
â”‚       â”‚   â”œâ”€â”€ images/         # StatickÃ© obrÃ¡zky (logo, screenshoty)
â”‚       â”‚   â”œâ”€â”€ favicon.svg
â”‚       â”‚   â””â”€â”€ robots.txt
â”‚       â”œâ”€â”€ functions/
â”‚       â”‚   â””â”€â”€ api/
â”‚       â”‚       â”œâ”€â”€ contact.ts     # POST /api/contact
â”‚       â”‚       â””â”€â”€ newsletter.ts  # POST /api/newsletter
â”‚       â”‚       â””â”€â”€ newsletter-confirm.ts  # GET /api/newsletter/confirm?token=...
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/
â”‚       â”‚   â”‚   â”œâ”€â”€ layout/     # Header, Footer, Navigation
â”‚       â”‚   â”‚   â”œâ”€â”€ sections/   # Hero, Features, Pricing, FAQ (statickÃ© .astro)
â”‚       â”‚   â”‚   â””â”€â”€ react/      # InteraktivnÃ­ ostrovy (ContactForm, Newsletter)
â”‚       â”‚   â”œâ”€â”€ content/
â”‚       â”‚   â”‚   â””â”€â”€ blog/
â”‚       â”‚   â”‚       â”œâ”€â”€ en/     # AnglickÃ© blogposty (.md)
â”‚       â”‚   â”‚       â”œâ”€â”€ cs/     # ÄŒeskÃ© blogposty (.md)
â”‚       â”‚   â”‚       â””â”€â”€ sk/     # SlovenskÃ© blogposty (.md)
â”‚       â”‚   â”œâ”€â”€ i18n/
â”‚       â”‚   â”‚   â”œâ”€â”€ en.json     # PÅ™eklady UI textÅ¯
â”‚       â”‚   â”‚   â”œâ”€â”€ cs.json
â”‚       â”‚   â”‚   â””â”€â”€ sk.json
â”‚       â”‚   â”œâ”€â”€ layouts/
â”‚       â”‚   â”‚   â””â”€â”€ Layout.astro
â”‚       â”‚   â”œâ”€â”€ pages/
â”‚       â”‚   â”‚   â”œâ”€â”€ en/         # AnglickÃ© strÃ¡nky
â”‚       â”‚   â”‚   â”œâ”€â”€ cs/         # ÄŒeskÃ© strÃ¡nky
â”‚       â”‚   â”‚   â”œâ”€â”€ sk/         # SlovenskÃ© strÃ¡nky
â”‚       â”‚   â”‚   â””â”€â”€ index.astro # Root redirect (Accept-Language)
â”‚       â”‚   â””â”€â”€ styles/
â”‚       â”‚       â””â”€â”€ global.css  # Reset, design token import, globÃ¡lnÃ­ typografie
â”‚       â”œâ”€â”€ astro.config.mjs
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared-types/           # ExistujÃ­cÃ­ sdÃ­lenÃ© TypeScript typy
â”‚   â”œâ”€â”€ design-tokens/          # NOVÃ â€” sdÃ­lenÃ© barvy, radii, shadows
â”‚   â”‚   â”œâ”€â”€ tokens.json         # KanonickÃ¡ definice
â”‚   â”‚   â””â”€â”€ variables.css       # CSS custom properties (generovÃ¡no z tokens.json)
â”‚   â””â”€â”€ emails/                 # NOVÃ â€” sdÃ­lenÃ© React Email Å¡ablony
â”‚       â”œâ”€â”€ WelcomeEmail.tsx
â”‚       â”œâ”€â”€ PasswordReset.tsx
â”‚       â”œâ”€â”€ RevisionReminder.tsx
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ worker/                     # Rust backend â€” beze zmÄ›n
â”œâ”€â”€ pnpm-workspace.yaml         # PÅ™idat apps/site, packages/*
â””â”€â”€ turbo.json                  # PÅ™idat build pipeline pro site
```

---

## 6. PlÃ¡n implementace

### FÃ¡ze 1: ZÃ¡klad (MVP)

**CÃ­l**: FunkÄnÃ­ marketing web nasazenÃ½ na Cloudflare Pages ve 3 jazycÃ­ch.

| # | Ãškol | Odhad |
|---|------|-------|
| 1.1 | Inicializace Astro projektu v `apps/site` | 1h |
| 1.2 | Konfigurace: React integration, i18n routing, global CSS | 2h |
| 1.3 | Design tokeny: extrakce do `packages/design-tokens` + barevnÃ¡ paleta dle loga | 3h |
| 1.4 | Layout.astro: SEO meta, OG tagy, fonty, analytics | 3h |
| 1.5 | Landing page: Hero + Problem/Solution + Features overview + CTA | 6h |
| 1.6 | Features page: detailnÃ­ popis funkcÃ­ | 4h |
| 1.7 | Pricing page: tabulka plÃ¡nÅ¯ | 3h |
| 1.8 | Contact page: formulÃ¡Å™ (vÃ½raznÃ½) + NewsletterForm (vÃ½raznÃ½) + FAQ | 3h |
| 1.9 | Legal pages: Privacy, Terms, Cookies | 3h |
| 1.10 | Blog: Content Collections setup + 1 testovacÃ­ ÄlÃ¡nek | 3h |
| 1.11 | i18n: pÅ™eklady vÅ¡ech UI textÅ¯ (en, cs, sk) | 4h |
| 1.12 | Language switcher + minimalistickÃ½ JS redirect (`navigator.language`, fallback `/en/`) | 2h |
| 1.13 | Header/Footer (navigace, logo, NewsletterForm mÃ©nÄ› vÃ½raznÄ›, social links) | 3h |
| 1.14 | Responsive design (mobile-first) | 4h |
| **Subtotal FÃ¡ze 1** | | **~44h** |

### FÃ¡ze 2: Backend & FormulÃ¡Å™e

| # | Ãškol | Odhad |
|---|------|-------|
| 2.1 | **Spike:** Resend SDK v Pages Functions (fallback REST pokud selÅ¾e) | 1h |
| 2.2 | Pages Functions + D1 setup (migrace, binding) | 2h |
| 2.3 | `POST /api/contact` endpoint (Zod, honeypot, Turnstile, D1, Resend, ÄitelnÃ½ ticketId) | 3h |
| 2.4 | `POST /api/newsletter` endpoint (double opt-in: pending + email with token) | 2h |
| 2.5 | `GET /api/newsletter/confirm` endpoint (token validation, state=confirmed) | 2h |
| 2.6 | NapojenÃ­ React formulÃ¡Å™Å¯ na `/api/contact` a `/api/newsletter` | 2h |
| **Subtotal FÃ¡ze 2** | | **~12h** |

### FÃ¡ze 3: Deployment & Polish

| # | Ãškol | Odhad |
|---|------|-------|
| 3.1 | Cloudflare Pages setup + custom domÃ©na | 2h |
| 3.2 | CI/CD: GitHub Actions pro automatickÃ½ deploy | 2h |
| 3.3 | Analytics setup (Umami Cloud) | 2h |
| 3.4 | Lighthouse audit + optimalizace (target: 100/100) | 3h |
| 3.5 | Hero screenshoty aplikace (WebP/AVIF, responsive) | 3h |
| 3.6 | Favicon + apple-touch-icon + web manifest | 1h |
| 3.7 | 404 strÃ¡nka (lokalizovanÃ¡) | 1h |
| **Subtotal FÃ¡ze 3** | | **~14h** |

### FÃ¡ze 4: RozÅ¡Ã­Å™enÃ­ (post-MVP)

| # | Ãškol | Odhad |
|---|------|-------|
| 4.1 | ROI kalkulaÄka (React island, `client:visible`) | 6h |
| 4.2 | DalÅ¡Ã­ blogovÃ© ÄlÃ¡nky (SEO strategie) | ongoing |
| 4.3 | A/B testing CTA variant | 4h |
| 4.4 | Video / animovanÃ© demo aplikace | 8h |
| 4.5 | ZÃ¡kaznickÃ© reference / case studies | 4h |

---

## 7. Performance cÃ­le

| Metrika | CÃ­l |
|---------|-----|
| Lighthouse Performance | 100 |
| Lighthouse Accessibility | 100 |
| Lighthouse Best Practices | 100 |
| Lighthouse SEO | 100 |
| First Contentful Paint (FCP) | < 0.8s |
| Largest Contentful Paint (LCP) | < 1.5s |
| Cumulative Layout Shift (CLS) | < 0.05 |
| Total Blocking Time (TBT) | < 50ms |
| JS bundle (landing page) | < 5 KB (pouze analytics script) |
| HTML size (landing page, gzipped) | < 30 KB |

---

## 8. Konvence

### Soubory a pojmenovÃ¡nÃ­
- Astro komponenty: `PascalCase.astro` (styly v `<style>` bloku â€” automaticky scoped)
- React islands: `PascalCase.tsx` + `PascalCase.module.css` v `src/components/react/`
- StrÃ¡nky: `kebab-case.astro` v `src/pages/{locale}/`
- Blog content: `YYYY-MM-DD-slug.md` v `src/content/blog/{locale}/`
- PÅ™eklady: `{locale}.json` v `src/i18n/`
- CSS class names: `camelCase` v CSS Modules (konzistentnÃ­ s `apps/web`)

### Git
- Feature branches: `site/feature-name`
- Commit prefix: `site:` pro zmÄ›ny v `apps/site`

### Kvalita
- TypeScript strict mode pro React islands
- Astro `--check` v CI
- Prettier + ESLint
- Lighthouse CI v GitHub Actions (fail pod 95)

---

## 9. ZÃ¡vislosti (package.json)

**`apps/site/package.json`** (Astro marketing web):
```json
{
  "name": "@ariadline/site",
  "dependencies": {
    "astro": "^5.x",
    "@astrojs/react": "^4.x",
    "@astrojs/sitemap": "^3.x",
    "@fontsource-variable/inter": "^5.x",
    "@fontsource-variable/montserrat": "^5.x",
    "resend": "^4.x",
    "@react-email/components": "^0.x",
    "zod": "^3.x",
    "react": "^19.x",
    "react-dom": "^19.x"
  },
  "devDependencies": {
    "sharp": "^0.33.x",
    "typescript": "^5.x"
  }
}
```

> PoznÃ¡mka: PÅ™esnÃ© verze se urÄÃ­ pÅ™i inicializaci projektÅ¯. React Email
> Å¡ablony sdÃ­lenÃ© s aplikacÃ­ budou v `packages/emails/`.

---

## 10. Rozhodnuto

- [x] AkcentnÃ­ barva â€” **#D97706** (zlatÃ¡, amber-700). Logo, trasa na mapÄ› ("Ariadnina nit"), non-blue akcenty. Barva trasy uÅ¾ivatelsky nastavitelnÃ¡.
- [x] Font â€” **Montserrat Variable** (nadpisy) + **Inter Variable** (body). Via Fontsource.
- [x] Backend formulÃ¡Å™Å¯ â€” **Cloudflare Pages Functions**. API na `ariadline.com/api/...`, Å¾Ã¡dnÃ© CORS.
- [x] Validace â€” **Zod**. SdÃ­lenÃ© schÃ©ma pro runtime validaci na klientovi i serveru.
- [x] I18n v Reactu â€” **Props drilling**. PÅ™eklady se naÄtou v `.astro` a pÅ™edajÃ­ React komponentÃ¡m jako props.
- [x] Analytics â€” **Umami Cloud** (hosted). PozdÄ›ji volitelnÃ¡ migrace na self-hosted.
- [x] Email sluÅ¾ba â€” **Resend**. Pro site (Pages Functions, TS SDK) i aplikaci (Rust worker, REST API).
- [x] Cookie consent banner â€” **nepotÅ™ebujeme**. Umami nepouÅ¾Ã­vÃ¡ cookies.
- [x] UklÃ¡dÃ¡nÃ­ dat â€” **Cloudflare D1** (managed SQLite) pro kontakty a newsletter.
- [x] Jazyky na root `/` â€” MinimalistickÃ½ JS redirect podle `navigator.language`; fallback bez JS je `/en/`.
- [x] NewsletterForm â€” **VÃ½raznÄ›** na Contact, **mÃ©nÄ› vÃ½raznÄ›** v patiÄce.
- [x] Honeypot â€” Pole `website`, skrytÃ© CSS, prÃ¡zdnÃ© = validnÃ­ request.
- [x] Newsletter â€” **Double opt-in**.
- [x] Source of truth â€” **D1**.
- [x] Ticket ID â€” ÄitelnÃ½ formÃ¡t `REQ-YYYY-NNNNNN`.
- [x] Anti-spam â€” **Cloudflare Turnstile** + honeypot + rate limiting.
- [x] Resend SDK v Pages â€” Å™eÅ¡it pÅ™es **spike** (FÃ¡ze 2.1).

## 11. OtevÅ™enÃ© otÃ¡zky

- [ ] **Design tokeny** â€” Jak generovat `variables.css` z `tokens.json`? Build skript v `packages/design-tokens`, nebo ruÄnÃ­ ÃºdrÅ¾ba?
- [ ] **Astro Content Collections** â€” PÅ™esnÃ¡ struktura blogu: jedna kolekce s `locale` v frontmatter, nebo oddÄ›lenÃ© sloÅ¾ky `blog/en/`, `blog/cs/`, `blog/sk/`? Jak napojit na i18n routing?
- [ ] **Resend SDK v Pages Functions** â€” VÃ½sledek spike (FÃ¡ze 2.1): potvrdit SDK nebo pÅ™epnout na ÄistÃ© REST volÃ¡nÃ­.
- [ ] **D1 retention policy** â€” Jak dlouho drÅ¾et kontaktnÃ­ zÃ¡znamy, pending newsletter tokeny a auditnÃ­ logy (GDPR)?

## 12. Definition of Done (DoD)

### 12.1 MVP DoD (site + forms)
- [ ] Root `/` pouÅ¾Ã­vÃ¡ minimalistickÃ½ JS redirect podle `navigator.language` (`en/cs/sk`)
- [ ] PÅ™i vypnutÃ©m JS je vÃ½chozÃ­ jazyk `/en/`
- [ ] StrÃ¡nky `/en`, `/cs`, `/sk` existujÃ­ pro Landing, Features, Pricing, Contact, Legal, Blog
- [ ] `ContactForm` je funkÄnÃ­ na `/contact`, uklÃ¡dÃ¡ data do D1 a vracÃ­ ÄitelnÃ½ `ticketId` formÃ¡tu `REQ-YYYY-NNNNNN`
- [ ] `NewsletterForm` je vÃ½raznÄ› na Contact a mÃ©nÄ› vÃ½raznÄ› v patiÄce vÅ¡ech strÃ¡nek
- [ ] Newsletter flow je double opt-in (`pending` â†’ `confirmed`) pÅ™es potvrzovacÃ­ link
- [ ] Source of truth pro kontakty i newsletter je D1
- [ ] Anti-spam aktivnÃ­: honeypot `website` + Cloudflare Turnstile + rate limiting
- [ ] Umami Cloud je zapojen pÅ™es script URL z dashboardu (`defer`)
- [ ] Resend e-maily fungujÃ­ pro contact notifikaci i newsletter confirmation
- [ ] PrÃ¡vnÃ­ strÃ¡nky (Privacy/Terms/Cookies) jsou publikovanÃ©

### 12.2 Technical DoD
- [ ] `astro check`, TypeScript a lint prochÃ¡zÃ­ bez chyb
- [ ] Lighthouse skÃ³re >= 95 ve vÅ¡ech kategoriÃ­ch (prod build)
- [ ] D1 migrace jsou verzovanÃ© a reproducibilnÃ­
- [ ] Secrets (`RESEND_API_KEY`, Turnstile secret, Umami site id) jsou jen v prostÅ™edÃ­, nikde v client kÃ³du
- [ ] Error monitoring/logging pro Functions zachytÃ­ chyby validace, D1 a Resend

### 12.3 Spike DoD â€” Resend SDK in Pages
- [x] ImplementovÃ¡n minimÃ¡lnÃ­ spike endpoint v Pages Functions
- [x] OvÄ›Å™eno v preview/prod, Å¾e SDK korektnÄ› odeÅ¡le e-mail
- [x] Pokud spike neprojde, zdokumentovÃ¡n fallback na REST API a pÅ™epnuto v implementaÄnÃ­m plÃ¡nu

---

## 13. Changelog

### 2026-02-12
- âœ… **Implementace dokonÄena** - VÅ¡ech 22 PR implementovÃ¡no podle plÃ¡nu
- âœ… **Responsive design** - Mobile-first CSS, breakpoints, accessibility (WCAG 2.1 AA)
- âœ… **CI/CD** - GitHub Actions workflow s Lighthouse CI a Cloudflare Pages deployment
- âœ… **Deployment dokumentace** - PÅ™esunuto do PROJECT_DEVOPS.MD sekce 16
- ğŸ› **Fix**: Oprava ÄeskÃ©ho pÅ™ekladu hero title: "Rozmotat vÃ¡Å¡" â†’ "Rozmotejte svÅ¯j"
- ğŸ“Š **VÃ½sledky**: 115 testÅ¯ âœ…, 28 strÃ¡nek, build ~5s, accessibility compliant
